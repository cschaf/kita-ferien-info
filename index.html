<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferienplan 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Base styles for light mode */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Light gray background */
            color: #374151; /* Default text color */
            min-height: 100vh; /* Ensure body takes at least full viewport height */
            display: flex; /* Use flexbox for overall layout to push footer down */
            flex-direction: column; /* Stack content vertically */
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth transition for dark mode */
        }
        .main-container {
            flex-grow: 1; /* Allow main content to grow and push footer down */
            max-width: 4xl; /* Tailwind max-width-4xl */
            margin-left: auto;
            margin-right: auto;
            padding: 1rem; /* p-4 */
            padding-top: 2rem; /* md:p-8, lg:p-12 */
            padding-bottom: 2rem; /* md:p-8, lg:p-12 */
        }
        @media (min-width: 768px) { /* md breakpoint */
            .main-container {
                padding: 2rem; /* md:p-8 */
            }
        }
        @media (min-width: 1024px) { /* lg breakpoint */
            .main-container {
                padding: 3rem; /* lg:p-12 */
            }
        }

        .card {
            background-color: #ffffff;
            border-radius: 12px; /* More rounded corners */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* Softer shadow */
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease-in-out; /* Smooth transition for past-card effect */
            border: 1px solid transparent; /* Default transparent border */
        }
        /* Header Section - Adjusted for Dark Mode Toggle Button */
        .header-section {
            background-color: #4f46e5; /* Indigo */
            color: #ffffff;
            padding: 2rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            text-align: center;
            transition: background-color 0.3s ease, color 0.3s ease;
            position: relative; /* Needed for absolute positioning of the toggle button */
            display: flex; /* Use flexbox for alignment */
            flex-direction: column; /* Stack content vertically by default */
            align-items: center; /* Center items horizontally */
            justify-content: center; /* Center items vertically */
        }
        .header-content {
            /* This div will wrap the title and paragraph to keep them together */
            text-align: center;
            flex-grow: 1; /* Allow content to take available space */
        }
        .section-title {
            color: #4f46e5; /* Indigo for section titles */
            font-weight: 700; /* Bold */
            margin-bottom: 1rem;
            border-bottom: 2px solid #e0e7ff; /* Light indigo border */
            padding-bottom: 0.5rem;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        .list-item {
            margin-bottom: 0.5rem;
            display: flex; /* Use flexbox */
            flex-direction: column; /* Always stack items vertically */
            align-items: flex-start; /* Align content to the start (left) */
            flex-wrap: wrap; /* Allow wrapping on small screens */
            gap: 0.25rem; /* Reduced gap between text and button */
            list-style-type: disc; /* Ensure regular list items have bullets */
        }
        .list-item strong {
            color: #374151; /* Darker gray for strong text */
            transition: color 0.3s ease;
        }
        /* Styling for highlighted deadline items */
        .deadline-highlight {
            background-color: #fff7ed; /* Very light orange/yellow background */
            border-left: 4px solid #f97316; /* Orange border */
            padding: 0.75rem 1rem; /* More padding */
            border-radius: 8px; /* Rounded corners */
            margin-top: 0.75rem; /* Space from previous item */
            margin-bottom: 0.75rem; /* Space to next item */
            display: flex; /* Keep flex for content alignment */
            flex-direction: column; /* Always stack items vertically */
            align-items: flex-start; /* Align content to the start (left) */
            flex-wrap: wrap;
            gap: 0.25rem; /* Reduced gap */
            list-style-type: none; /* Remove bullet point */
            /* Adjust padding-left to align with other list items that have pl-5 (1.25rem) */
            padding-left: calc(1rem + 1.25rem); /* Base padding + ul's padding */
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .deadline-highlight strong {
            color: #dc2626; /* Keep red for the text */
            font-weight: 800; /* Extra bold */
            font-size: 1.05rem; /* Slightly larger font */
            transition: color 0.3s ease;
        }
        /* Combined Note and Disclaimer Section */
        .note-disclaimer-section {
            background-color: #fff7ed; /* Matches deadline-highlight background */
            border-left: 5px solid #f97316; /* Matches deadline-highlight border */
            padding: 1.5rem; /* Slightly more padding than deadline-highlight for content */
            border-radius: 12px; /* Rounded corners */
            margin-top: 2rem;
            margin-bottom: 2rem; /* Space before next elements */
            color: #374151; /* Default text color for readability */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); /* Subtle shadow */
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }
        .note-disclaimer-section p {
            margin-bottom: 0.5rem; /* Space between paragraphs */
        }
        .note-disclaimer-section .disclaimer-text {
            font-size: 0.875rem; /* text-sm */
            color: #6b7280; /* Gray text for disclaimer part */
            text-align: center; /* Center disclaimer text */
            margin-top: 1rem; /* Space after note content */
            padding-top: 1rem; /* Padding before disclaimer text */
            border-top: 1px solid #e5e7eb; /* Light gray border above disclaimer */
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        .note-disclaimer-section .note-title {
            color: #dc2626; /* Red color for the title of the note */
            font-weight: 800; /* Extra bold for the title */
            transition: color 0.3s ease;
        }


        .calendar-button {
            flex-shrink: 0; /* Prevent button from shrinking */
            background-color: #e0e7ff; /* Very light indigo */
            color: #4f46e5; /* Indigo text */
            font-weight: 500; /* Medium weight */
            padding: 0.3rem 0.75rem; /* Smaller padding */
            border-radius: 6px; /* Slightly less rounded, more uniform */
            font-size: 0.75rem; /* text-xs */
            border: 1px solid #c7d2fe; /* Light indigo border */
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap; /* Prevent button text from wrapping */
            margin-top: 0.5rem; /* Space from the text above it */
            align-self: flex-start; /* Align button to the left within its flex container */
        }
        .calendar-button:hover {
            background-color: #c7d2fe; /* Slightly darker light indigo on hover */
            border-color: #a5b4fc; /* Darker border on hover */
        }
        .calendar-button i {
            margin-right: 0.25rem; /* Space between icon and text */
        }


        /* Styling for past event cards */
        .past-card {
            background-color: #e9ecef; /* Lighter gray background */
            color: #6c757d; /* Grayer text */
            opacity: 0.7; /* Slightly reduce opacity */
            box-shadow: none; /* Remove shadow for past events to make them less prominent */
            border: 1px solid #dee2e6; /* Add a light border */
            transition: all 0.3s ease-in-out;
        }
        .past-card .section-title,
        .past-card .list-item strong {
            color: #6c757d; /* Ensure all text within is grayed out */
            transition: color 0.3s ease;
        }
        .past-card .deadline-highlight strong {
            color: #868e96; /* Even lighter gray for past highlighted text */
            transition: color 0.3s ease;
        }
        .past-card .calendar-button {
            background-color: #ced4da; /* Grayer button */
            color: #495057; /* Darker gray text for button */
            border-color: #adb5bd; /* Grayer border */
            cursor: default; /* Indicate it's less interactive */
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }
        .past-card .calendar-button:hover {
            background-color: #adb5bd;
            border-color: #6c757d;
        }
        .past-card .deadline-highlight {
            background-color: #e9ecef; /* Match card background */
            border-left-color: #adb5bd; /* Grayer border for deadline highlight */
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        /* Styling for current event card */
        .current-card {
            border: 2px solid #10b981; /* Emerald green border */
            background-color: #ecfdf5; /* Light emerald background */
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.2); /* Stronger shadow */
            opacity: 1;
            transition: all 0.3s ease-in-out;
        }
        .current-card .section-title {
            color: #059669; /* Darker emerald for title */
            transition: color 0.3s ease;
        }
        .current-card .list-item strong {
            color: #065f46; /* Darker green for strong text */
            transition: color 0.3s ease;
        }

        /* Styling for upcoming event card */
        .upcoming-card {
            border: 2px solid #3b82f6; /* Blue border */
            background-color: #e0f2fe; /* Light blue background */
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.2); /* Stronger shadow */
            opacity: 1;
            transition: all 0.3s ease-in-out;
        }
        .upcoming-card .section-title {
            color: #1d4ed8; /* Darker blue for title */
            transition: color 0.3s ease;
        }
        .upcoming-card .list-item strong {
            color: #1e40af; /* Darker blue for strong text */
            transition: color 0.3s ease;
        }

        /* Filter and Sort Controls */
        .controls-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
        }
        .controls-container label {
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
            display: block;
            transition: color 0.3s ease;
        }
        .controls-container select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background-color: #f9fafb;
            font-size: 1rem;
            color: #4b5563;
            appearance: none; /* Remove default arrow */
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none'%3e%3cpath d='M7 7l3-3 3 3m0 6l-3 3-3-3' stroke='%236b7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1em;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }
        .controls-container select:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        .controls-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .controls-right-aligned {
            display: flex;
            justify-content: flex-end; /* Push content to the right */
            width: 100%; /* Take full width */
        }

        @media (min-width: 640px) { /* sm breakpoint */
            .controls-container {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            .controls-group {
                flex-direction: row;
                align-items: center;
                gap: 1rem;
            }
            .controls-group > div {
                flex: 1;
            }
            .controls-right-aligned {
                width: auto; /* Allow it to shrink to content size */
            }
        }

        /* Print Button Styling */
        .print-button {
            background-color: #10b981; /* Emerald green */
            color: #ffffff;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .print-button:hover {
            background-color: #059669; /* Darker emerald */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .print-button i {
            margin-right: 0.5rem;
        }

        /* Legend Styling */
        .legend-container {
            margin-top: 2rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
        }
        .legend-title {
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* Bold */
            color: #4f46e5; /* Indigo */
            margin-bottom: 1rem;
            border-bottom: 1px solid #e0e7ff;
            padding-bottom: 0.5rem;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center; /* Center items on larger screens */
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: #4b5563;
            transition: color 0.3s ease;
        }
        .color-box {
            width: 1.25rem;
            height: 1.25rem;
            border-radius: 4px;
            border: 1px solid #d1d5db; /* Default border for color boxes */
            flex-shrink: 0; /* Prevent shrinking */
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        .past-color {
            background-color: #e9ecef; /* Matches past-card background */
            border-color: #dee2e6;
        }
        .current-color {
            background-color: #ecfdf5; /* Matches current-card background */
            border-color: #10b981; /* Matches current-card border */
        }
        .upcoming-color {
            background-color: #e0f2fe; /* Matches upcoming-card background */
            border-color: #3b82f6; /* Matches upcoming-card border */
        }
        .deadline-color {
            background-color: #fff7ed; /* Matches deadline-highlight background */
            border-color: #f97316; /* Matches deadline-highlight border */
        }
        .legend-icon {
            color: #4f46e5; /* Match calendar button color */
            font-size: 1.25rem;
            transition: color 0.3s ease;
        }

        /* Responsive adjustments for legend items */
        @media (max-width: 639px) { /* Targets screens smaller than sm breakpoint */
            .legend-items {
                flex-direction: column; /* Stack items vertically */
                align-items: flex-start; /* Align items to the left */
                gap: 0.75rem; /* Adjust gap for stacked items */
            }
        }

        /* Footer Styling */
        .footer-section {
            margin-top: 3rem;
            padding: 2rem 1.5rem;
            background-color: #374151; /* Dark gray background */
            color: #d1d5db; /* Light gray text */
            text-align: center;
            border-radius: 12px;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.5;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .footer-section p {
            margin-bottom: 0.5rem;
        }
        .footer-section a {
            color: #a5b4fc; /* Light indigo for links */
            text-decoration: underline;
            transition: color 0.3s ease;
        }
        .footer-section a:hover {
            color: #c7d2fe; /* Lighter indigo on hover */
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text color */
        }
        body.dark-mode .card {
            background-color: #2d3748; /* Darker card background */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* Stronger shadow for contrast */
            border-color: #4a5568; /* Darker border */
        }
        body.dark-mode .header-section {
            background-color: #4338ca; /* Darker indigo */
            color: #ffffff;
        }
        body.dark-mode .section-title {
            color: #9f7aea; /* Lighter indigo for titles */
            border-bottom-color: #4a5568; /* Darker border */
        }
        body.dark-mode .list-item strong {
            color: #e2e8f0; /* Lighter text for strong */
        }
        body.dark-mode .deadline-highlight {
            background-color: #4a2f00; /* Darker orange/brown for deadline */
            border-left-color: #f97316; /* Keep orange border */
        }
        body.dark-mode .deadline-highlight strong {
            color: #ef4444; /* Brighter red for deadline text */
        }
        body.dark-mode .note-disclaimer-section {
            background-color: #4a2f00; /* Darker orange/brown for note */
            border-left-color: #f97316; /* Keep orange border */
            color: #e2e8f0; /* Light text */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .note-disclaimer-section .disclaimer-text {
            color: #a0aec0; /* Lighter gray for disclaimer */
            border-top-color: #4a5568; /* Darker border */
        }
        body.dark-mode .note-disclaimer-section .note-title {
            color: #ef4444; /* Brighter red for note title */
        }
        body.dark-mode .calendar-button {
            background-color: #6366f1; /* Darker indigo button */
            color: #ffffff;
            border-color: #4f46e5;
        }
        body.dark-mode .calendar-button:hover {
            background-color: #4f46e5;
            border-color: #3730a3;
        }

        /* Dark mode for past cards */
        body.dark-mode .past-card {
            background-color: #374151; /* Darker gray for past cards */
            color: #a0aec0; /* Lighter gray text */
            opacity: 0.8; /* Slightly less opaque */
            border-color: #4a5568;
        }
        body.dark-mode .past-card .section-title,
        body.dark-mode .past-card .list-item strong {
            color: #a0aec0;
        }
        body.dark-mode .past-card .deadline-highlight strong {
            color: #cbd5e0; /* Even lighter gray for past highlighted text */
        }
        body.dark-mode .past-card .calendar-button {
            background-color: #4a5568;
            color: #e2e8f0;
            border-color: #6b7280;
        }
        body.dark-mode .past-card .calendar-button:hover {
            background-color: #6b7280;
            border-color: #4a5568;
        }
        body.dark-mode .past-card .deadline-highlight {
            background-color: #374151; /* Match card background */
            border-left-color: #6b7280; /* Grayer border for deadline highlight */
        }

        /* Dark mode for current card */
        body.dark-mode .current-card {
            border-color: #10b981; /* Keep emerald green border */
            background-color: #166534; /* Darker emerald background */
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4); /* Stronger shadow */
        }
        body.dark-mode .current-card .section-title {
            color: #34d399; /* Lighter emerald for title */
        }
        body.dark-mode .current-card .list-item strong {
            color: #a7f3d0; /* Lighter green for strong text */
        }

        /* Dark mode for upcoming card */
        body.dark-mode .upcoming-card {
            border-color: #3b82f6; /* Keep blue border */
            background-color: #1e3a8a; /* Darker blue background */
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4); /* Stronger shadow */
        }
        body.dark-mode .upcoming-card .section-title {
            color: #60a5fa; /* Lighter blue for title */
        }
        body.dark-mode .upcoming-card .list-item strong {
            color: #93c5fd; /* Lighter blue for strong text */
        }

        /* Dark mode for controls */
        body.dark-mode .controls-container {
            background-color: #2d3748;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .controls-container label {
            color: #e2e8f0;
        }
        body.dark-mode .controls-container select {
            border-color: #4a5568;
            background-color: #4a5568;
            color: #e2e8f0;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none'%3e%3cpath d='M7 7l3-3 3 3m0 6l-3 3-3-3' stroke='%23e2e8f0' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3e%3c/svg%3e"); /* Lighter arrow for dark mode */
        }
        body.dark-mode .controls-container select:focus {
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.4);
        }

        /* Dark mode for print button */
        body.dark-mode .print-button {
            background-color: #059669;
            color: #ffffff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .print-button:hover {
            background-color: #047857;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* Dark mode for legend */
        body.dark-mode .legend-container {
            background-color: #2d3748;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .legend-title {
            color: #9f7aea;
            border-bottom-color: #4a5568;
        }
        body.dark-mode .legend-item {
            color: #e2e8f0;
        }
        body.dark-mode .color-box {
            border-color: #4a5568;
        }
        body.dark-mode .legend-icon {
            color: #9f7aea;
        }
        body.dark-mode .past-color {
            background-color: #374151;
            border-color: #4a5568;
        }
        body.dark-mode .current-color {
            background-color: #166534;
            border-color: #10b981;
        }
        body.dark-mode .upcoming-color {
            background-color: #1e3a8a;
            border-color: #3b82f6;
        }
        body.dark-mode .deadline-color {
            background-color: #4a2f00;
            border-color: #f97316;
        }

        /* Dark mode for footer */
        body.dark-mode .footer-section {
            background-color: #111827; /* Even darker background for footer */
            color: #a0aec0;
            border-top: 2px solid #374151; /* Add a subtle top border for separation */
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.3); /* Add shadow to the top for separation */
        }
        body.dark-mode .footer-section a {
            color: #c7d2fe;
        }
        body.dark-mode .footer-section a:hover {
            color: #a5b4fc;
        }

        /* Dark mode toggle button styling */
        .dark-mode-toggle {
            background-color: #4f46e5;
            color: #ffffff;
            font-weight: 600;
            padding: 0.5rem; /* Smaller padding for icon-only button */
            border-radius: 50%; /* Make it round */
            width: 2.5rem; /* Fixed width for round button */
            height: 2.5rem; /* Fixed height for round button */
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: absolute; /* Position it absolutely within the header */
            top: 1rem; /* Adjust as needed */
            right: 1.5rem; /* Adjust as needed */
            z-index: 10; /* Ensure it's above other content */
            font-size: 1.25rem; /* Icon size */
        }
        .dark-mode-toggle:hover {
            background-color: #4338ca;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        body.dark-mode .dark-mode-toggle {
            background-color: #6366f1;
        }
        body.dark-mode .dark-mode-toggle:hover {
            background-color: #4f46e5;
        }

        /* Print-specific styles */
        @media print {
            body {
                background-color: #ffffff; /* White background for print */
                color: #000000; /* Black text for print */
                margin: 0;
                padding: 0;
            }
            .main-container {
                padding: 1cm; /* Standard print margins */
                max-width: none; /* No max-width for print */
                width: 100%;
            }
            .header-section,
            .controls-container, /* Hide the entire controls container for print */
            .calendar-button,
            .note-disclaimer-section, /* Hide combined section for print */
            .legend-container, /* Hide legend for print */
            .footer-section,
            .dark-mode-toggle { /* Hide footer and toggle for print */
                display: none !important;
            }
            .card {
                box-shadow: none; /* No shadows in print */
                border: 1px solid #ccc; /* Light border for cards */
                margin-bottom: 1rem;
                padding: 1rem;
                opacity: 1 !important; /* Ensure past cards are fully visible for print */
                color: #000000 !important; /* Ensure text is black */
                background-color: #ffffff !important; /* Ensure background is white */
            }
            .card .section-title,
            .card .list-item strong,
            .card .deadline-highlight strong {
                color: #000000 !important; /* Ensure all text is black */
            }
            .card.past-card {
                opacity: 1 !important; /* Override opacity for print */
                background-color: #f8f9fa !important; /* Slightly off-white for past cards in print */
                border-color: #e9ecef !important;
            }
            .card.current-card,
            .card.upcoming-card {
                border-color: #000000 !important; /* Black border for active/upcoming in print */
            }
            .list-item, .deadline-highlight {
                padding-left: 0; /* Remove extra padding for print */
                margin-bottom: 0.25rem;
            }
            ul {
                padding-left: 1.5rem; /* Standard ul padding for print */
            }
        }
    </style>
</head>
<body class="p-4 md:p-8 lg:p-12">
<div class="main-container">
    <header class="header-section">
        <button id="darkModeToggle" class="dark-mode-toggle" aria-label="Toggle dark mode">
            <i class="fas fa-moon"></i>
        </button>

        <div class="header-content">
            <h1 class="text-3xl md:text-4xl font-bold mb-2">Ferienplan 2025</h1>
            <p class="text-lg md:text-xl">Übersicht über Ferienzeiten und Schließtage der Kita</p>
        </div>
    </header>

    <div class="note-disclaimer-section">
        <p class="font-semibold text-lg mb-2 note-title">Wichtiger Hinweis zur Anmeldung:</p>
        <p>Die Anmeldung für die Feriendienste erfolgt ausschließlich im Büro – persönlich, telefonisch oder per Mail!</p>
        <p class="disclaimer-text">Alle Angaben ohne Gewähr.</p>
    </div>

    <div class="legend-container">
        <h2 class="legend-title">Legende</h2>
        <div class="legend-items">
            <div class="legend-item">
                <span class="color-box past-color"></span>
                <span>Vergangene Termine</span>
            </div>
            <div class="legend-item">
                <span class="color-box current-color"></span>
                <span>Aktuelle Termine</span>
            </div>
            <div class="legend-item">
                <span class="color-box upcoming-color"></span>
                <span>Nächste kommende Termine</span>
            </div>
            <div class="legend-item">
                <span class="color-box deadline-color"></span>
                <span>Wichtiger Hinweis</span>
            </div>
            <div class="legend-item">
                <i class="fas fa-calendar-plus legend-icon"></i>
                <span>Kalender-Eintrag hinzufügen</span>
            </div>
        </div>
    </div>

    <div class="controls-container">
        <div class="controls-group">
            <div>
                <label for="filterOptions">Filter:</label>
                <select id="filterOptions">
                    <option value="all">Alle Termine</option>
                    <option value="upcoming">Nur kommende Termine</option>
                </select>
            </div>
            <div>
                <label for="sortOptions">Sortierung:</label>
                <select id="sortOptions">
                    <option value="asc">Älteste zuerst</option>
                    <option value="desc">Neueste zuerst</option>
                </select>
            </div>
        </div>
        <div class="controls-right-aligned">
            <button class="print-button" onclick="window.print()">
                <i class="fas fa-print"></i> Drucken
            </button>
        </div>
    </div>

    <main id="cards-container">
        <section class="card" data-start-date="2025-02-03" data-end-date="2025-02-04">
            <h2 class="section-title text-2xl md:text-3xl">Winterferien</h2>
            <ul class="list-disc pl-5">
                <li class="list-item">
                        <span>
                            <strong>Zeitraum:</strong> 03.02. - 04.02.2025
                        </span>
                    <button onclick="downloadICS('Feriendienst Winterferien', '20250203', '20250205', 'Feriendienst Winterferien', 'Feriendienst nur für Kinder von berufstätigen Eltern (Vorbereitung/Durchführung der Entwicklungsgespräche).')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="deadline-highlight">
                        <span>
                            <strong>Letzter Anmeldetag für den Feriendienst:</strong> 10.01.2025
                        </span>
                    <button onclick="downloadICS('Anmeldetag Winterferien', '20250110', '20250111', 'Letzter Anmeldetag Winterferien', 'Letzter Anmeldetag für den Feriendienst Winterferien.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
            </ul>
        </section>

        <section class="card" data-start-date="2025-04-07" data-end-date="2025-04-21">
            <h2 class="section-title text-2xl md:text-3xl">Osterferien</h2>
            <ul class="list-disc pl-5">
                <li class="list-item">
                        <span>
                            <strong>Zeitraum:</strong> 07.04. - 21.04.2025
                        </span>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Feriendienst:</strong> 07.04. - 17.04.2025
                        </span>
                    <button onclick="downloadICS('Feriendienst Osterferien', '20250407', '20250418', 'Feriendienst Osterferien', 'Feriendienst vom 07.04.2025 bis 17.04.2025.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="deadline-highlight">
                        <span>
                            <strong>Letzter Anmeldetag für den Feriendienst:</strong> 14.03.2025
                        </span>
                    <button onclick="downloadICS('Anmeldetag Osterferien', '20250314', '20250315', 'Letzter Anmeldetag Osterferien', 'Letzter Anmeldetag für den Feriendienst Osterferien.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
            </ul>
        </section>

        <section class="card" data-start-date="2025-05-01" data-end-date="2025-06-10">
            <h2 class="section-title text-2xl md:text-3xl">Feiertage & Brückentage</h2>
            <ul class="list-disc pl-5">
                <li class="list-item">
                        <span>
                            <strong>Feiertag 1. Mai 2025 (Tag der Arbeit)</strong>
                        </span>
                    <button onclick="downloadICS('Feiertag Tag der Arbeit', '20250501', '20250502', 'Feiertag Tag der Arbeit', 'Gesetzlicher Feiertag.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            Kita geschlossen: 02. Mai 2025 (Brückentag)
                        </span>
                    <button onclick="downloadICS('Kita geschlossen Brückentag', '20250502', '20250503', 'Kita geschlossen (Brückentag)', 'Kita geschlossen aufgrund Brückentag nach dem 1. Mai.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Feiertag 29. Mai 2025 (Christi Himmelfahrt)</strong>
                        </span>
                    <button onclick="downloadICS('Feiertag Christi Himmelfahrt', '20250529', '20250530', 'Feiertag Christi Himmelfahrt', 'Gesetzlicher Feiertag.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            Kita geschlossen: 30. Mai 2025 (Brückentag)
                        </span>
                    <button onclick="downloadICS('Kita geschlossen Brückentag', '20250530', '20250531', 'Kita geschlossen (Brückentag)', 'Kita geschlossen aufgrund Brückentag nach Christi Himmelfahrt.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Kita geschlossen:</strong> 10.06.2025 (Planungstag für alle Mitarbeitenden)
                        </span>
                    <button onclick="downloadICS('Kita geschlossen Planungstag', '20250610', '20250611', 'Kita geschlossen (Planungstag)', 'Planungstag für alle Mitarbeitende.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
            </ul>
        </section>

        <section class="card" data-start-date="2025-07-03" data-end-date="2025-08-13">
            <h2 class="section-title text-2xl md:text-3xl">Sommerferien</h2>
            <ul class="list-disc pl-5">
                <li class="list-item">
                        <span>
                            <strong>Zeitraum:</strong> 03.07. - 13.08.2025
                        </span>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Feriendienst (Teil 1):</strong> 03.07. - 11.07.2025
                        </span>
                    <button onclick="downloadICS('Feriendienst Sommerferien Teil 1', '20250703', '20250712', 'Feriendienst Sommerferien (Teil 1)', 'Feriendienst vom 03.07.2025 bis 11.07.2025.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Feriendienst (Teil 2):</strong> 04.08. - 13.08.2025
                        </span>
                    <button onclick="downloadICS('Feriendienst Sommerferien Teil 2', '20250804', '20250814', 'Feriendienst Sommerferien (Teil 2)', 'Feriendienst vom 04.08.2025 bis 13.08.2025.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Kita geschlossen:</strong> 14.07.2025 bis 01.08.2025
                        </span>
                    <button onclick="downloadICS('Kita geschlossen Sommer', '20250714', '20250802', 'Kita geschlossen (Sommer)', 'Kita geschlossen während der Sommerferien.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="deadline-highlight">
                        <span>
                            <strong>Letzter Anmeldetag für den Feriendienst:</strong> 13.06.2025
                        </span>
                    <button onclick="downloadICS('Anmeldetag Sommerferien', '20250613', '20250614', 'Letzter Anmeldetag Sommerferien', 'Letzter Anmeldetag für den Feriendienst Sommerferien.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
            </ul>
        </section>

        <section class="card" data-start-date="2025-10-13" data-end-date="2025-10-24">
            <h2 class="section-title text-2xl md:text-3xl">Herbstferien</h2>
            <ul class="list-disc pl-5">
                <li class="list-item">
                        <span>
                            <strong>Zeitraum:</strong> 13.10. - 24.10.2025
                        </span>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Feriendienst:</strong> 13.10. - 24.10.2025
                        </span>
                    <button onclick="downloadICS('Feriendienst Herbstferien', '20251013', '20251025', 'Feriendienst Herbstferien', 'Feriendienst vom 13.10.2025 bis 24.10.2025.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="deadline-highlight">
                        <span>
                            <strong>Letzter Anmeldetag für den Feriendienst:</strong> 19.09.2025
                        </span>
                    <button onclick="downloadICS('Anmeldetag Herbstferien', '20250919', '20250920', 'Letzter Anmeldetag Herbstferien', 'Letzter Anmeldetag für den Feriendienst Herbstferien.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
            </ul>
        </section>

        <section class="card" data-start-date="2025-12-22" data-end-date="2026-01-02">
            <h2 class="section-title text-2xl md:text-3xl">Weihnachtsferien</h2>
            <ul class="list-disc pl-5">
                <li class="list-item">
                        <span>
                            <strong>Zeitraum:</strong> 22.12.2025 bis 01.01.2026
                        </span>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Feriendienst:</strong> 22.12.2025 (ausschließlich für Kinder von berufstätigen Eltern)
                        </span>
                    <button onclick="downloadICS('Feriendienst Weihnachtsferien', '20251222', '20251223', 'Feriendienst Weihnachtsferien', 'Feriendienst ausschließlich für Kinder von berufstätigen Eltern.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Kita geschlossen:</strong> 23.12.2025 - 02.01.2026
                        </span>
                    <button onclick="downloadICS('Kita geschlossen Weihnachten', '20251223', '20260103', 'Kita geschlossen (Weihnachten)', 'Kita geschlossen über die Weihnachtsferien.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="list-item">
                        <span>
                            <strong>Kita geschlossen:</strong> 02.01.2026 (Planungstag Mitarbeitende)
                        </span>
                    <button onclick="downloadICS('Kita geschlossen Planungstag 2026', '20260102', '20260103', 'Kita geschlossen (Planungstag 2026)', 'Planungstag für Mitarbeitende im neuen Jahr.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
                <li class="deadline-highlight">
                        <span>
                            <strong>Letzter Anmeldetag für den Feriendienst:</strong> 05.12.2025
                        </span>
                    <button onclick="downloadICS('Anmeldetag Weihnachtsferien', '20251205', '20251206', 'Letzter Anmeldetag Weihnachtsferien', 'Letzter Anmeldetag für den Feriendienst Weihnachtsferien.')" class="calendar-button">
                        <i class="fas fa-calendar-plus"></i> Kalender
                    </button>
                </li>
            </ul>
        </section>
    </main>
</div>

<footer class="footer-section">
    <p>Dies ist ein privates Projekt und steht in keiner Verbindung zur Kita.</p>
    <p>Die Informationen auf dieser Seite wurden allgemein von der Kita an alle verteilt.</p>
    <p>Ich habe nicht mehr Informationen als alle anderen auch. Alle Angaben sind ohne Gewähr.</p>
    <p>
        <a href="images/2025-Ferien.jpg" target="_blank" rel="noopener noreferrer">
            Link zur originalen Liste mit den Terminen (JPG)
        </a>
    </p>
</footer>

<script>
    // Global variable to store all original cards
    let allCards = [];

    /**
     * Toggles dark mode on and off.
     * Stores the preference in localStorage.
     */
    function toggleDarkMode() {
        const body = document.body;
        body.classList.toggle('dark-mode');
        const isDarkMode = body.classList.contains('dark-mode');
        localStorage.setItem('darkMode', isDarkMode ? 'enabled' : 'disabled');

        // Update button icon
        const darkModeToggleIcon = document.querySelector('#darkModeToggle i');
        if (isDarkMode) {
            darkModeToggleIcon.classList.remove('fa-moon');
            darkModeToggleIcon.classList.add('fa-sun');
        } else {
            darkModeToggleIcon.classList.remove('fa-sun');
            darkModeToggleIcon.classList.add('fa-moon');
        }
    }

    /**
     * Generates and downloads an ICS calendar file.
     * @param {string} filename The name of the file to download (e.g., "Winterferien").
     * @param {string} dtstart The start date in INSEE-YYYYMMDD format (e.g., "20250203").
     * @param {string} dtend The end date in INSEE-YYYYMMDD format. For all-day events, this is the day *after* the event ends.
     * @param {string} summary The summary/title of the event.
     * @param {string} description The description of the event.
     * @param {string} [location='Kita'] The location of the event.
     */
    function downloadICS(filename, dtstart, dtend, summary, description, location = 'Kita') {
        const uid = Date.now().toString(36) + Math.random().toString(36).substr(2); // Unique ID for the event
        const now = new Date();
        const created = now.toISOString().replace(/[-:]|\.\d{3}/g, '', 'Z'); // Current timestamp in INSEE-YYYYMMDDTHHMMSSZ

        const icsContent = [
            'BEGIN:VCALENDAR',
            'VERSION:2.0',
            'PRODID:-//Google Inc//Google Calendar 70.9054//EN',
            'CALSCALE:GREGORIAN',
            'BEGIN:VEVENT',
            `DTSTAMP:${created}`,
            `UID:${uid}@ferienplan.kita.de`, // Unique ID for the event
            `DTSTART;VALUE=DATE:${dtstart}`, // All-day event start
            `DTEND;VALUE=DATE:${dtend}`,     // All-day event end (exclusive)
            `SUMMARY:${summary}`,
            `DESCRIPTION:${description}`,
            `LOCATION:${location}`,
            'END:VEVENT',
            'END:VCALENDAR'
        ].join('\n');

        const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${filename}.ics`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url); // Clean up the object URL
    }

    /**
     * Checks if a given date is in the past compared to the current date.
     * @param {string} dateString - Date in 'YYYY-MM-DD' format.
     * @returns {boolean} True if the date is in the past, false otherwise.
     */
    function isDateInPast(dateString) {
        const today = new Date();
        today.setHours(0, 0, 0, 0); // Normalize today to start of day

        const checkDate = new Date(dateString);
        checkDate.setHours(0, 0, 0, 0); // Normalize checkDate to start of day

        return checkDate < today;
    }

    /**
     * Checks if a given date is in the future compared to the current date.
     * @param {string} dateString - Date in 'YYYY-MM-DD' format.
     * @returns {boolean} True if the date is in the future, false otherwise.
     */
    function isDateInFuture(dateString) {
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        const checkDate = new Date(dateString);
        checkDate.setHours(0, 0, 0, 0);

        return checkDate > today;
    }

    /**
     * Checks if a given date is today.
     * @param {string} dateString - Date in 'YYYY-MM-DD' format.
     * @returns {boolean} True if the date is today, false otherwise.
     */
    function isDateToday(dateString) {
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        const checkDate = new Date(dateString);
        checkDate.setHours(0, 0, 0, 0);

        return checkDate.getTime() === today.getTime();
    }

    /**
     * Applies filters and sorting, then updates visual highlighting.
     */
    function applyFiltersAndSorting() {
        const filterSelect = document.getElementById('filterOptions');
        const sortSelect = document.getElementById('sortOptions');
        const cardsContainer = document.getElementById('cards-container');

        const selectedFilter = filterSelect.value;
        const selectedSort = sortSelect.value;

        // Start with the complete set of original cards
        let processedCards = [...allCards]; // Create a shallow copy to avoid modifying the original array

        // 1. Filter cards
        processedCards = processedCards.filter(card => {
            const startDateStr = card.dataset.startDate;
            const endDateStr = card.dataset.endDate;

            if (!startDateStr || !endDateStr) return true; // Keep if dates are missing

            const startDate = new Date(startDateStr);
            startDate.setHours(0, 0, 0, 0);
            const endDate = new Date(endDateStr);
            endDate.setHours(0, 0, 0, 0);

            if (selectedFilter === 'upcoming') {
                const today = new Date();
                today.setHours(0,0,0,0);
                // An event is "upcoming" if its start date is in the future OR if it's currently active.
                return startDate >= today || (startDate <= today && endDate >= today);
            }
            return true; // 'all' filter, keep all cards
        });

        // 2. Sort filtered cards
        processedCards.sort((a, b) => {
            const dateA = new Date(a.dataset.startDate);
            const dateB = new Date(b.dataset.startDate);

            if (selectedSort === 'asc') {
                return dateA.getTime() - dateB.getTime();
            } else { // 'desc'
                return dateB.getTime() - dateA.getTime();
            }
        });

        // 3. Re-append sorted and filtered cards to the DOM
        // Clear current content
        cardsContainer.innerHTML = '';
        // Append sorted cards
        processedCards.forEach(card => cardsContainer.appendChild(card));

        // 4. After filtering and sorting, re-apply the visual highlighting
        updateVisualHighlighting();
    }

    /**
     * Applies visual highlighting (past, current, upcoming) to cards.
     * This function should be called after filtering and sorting.
     */
    function updateVisualHighlighting() {
        const cards = document.querySelectorAll('.card'); // Get cards currently in DOM
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        let soonestUpcomingStartDate = Infinity;
        let soonestUpcomingCard = null;

        cards.forEach(card => {
            const startDateStr = card.dataset.startDate;
            const endDateStr = card.dataset.endDate;

            // Remove all highlighting classes first
            card.classList.remove('past-card', 'current-card', 'upcoming-card');

            if (!startDateStr || !endDateStr) {
                console.warn('Card missing start or end date:', card);
                return;
            }

            const startDate = new Date(startDateStr);
            startDate.setHours(0, 0, 0, 0);
            const endDate = new Date(endDateStr);
            endDate.setHours(0, 0, 0, 0);

            // Check for Past
            if (endDate < today) {
                card.classList.add('past-card');
            }
            // Check for Current (today is within the event period)
            else if (startDate <= today && endDate >= today) {
                card.classList.add('current-card');
            }
            // Check for Upcoming (find the soonest one among non-past/non-current cards)
            else if (startDate > today) {
                if (startDate.getTime() < soonestUpcomingStartDate) {
                    soonestUpcomingStartDate = startDate.getTime();
                    soonestUpcomingCard = card;
                }
            }
        });

        // Apply 'upcoming-card' class to the soonest upcoming event after iterating all cards
        if (soonestUpcomingCard) {
            soonestUpcomingCard.classList.add('upcoming-card');
        }
    }


    // Initial setup when the DOM is fully loaded
    document.addEventListener('DOMContentLoaded', () => {
        // Check for dark mode preference on load
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
            document.querySelector('#darkModeToggle i').classList.remove('fa-moon');
            document.querySelector('#darkModeToggle i').classList.add('fa-sun');
        }

        // Store all cards initially
        allCards = Array.from(document.querySelectorAll('.card')).map(card => card.cloneNode(true)); // Deep clone to preserve event listeners if any

        // Apply filters and sorting initially (this will also trigger visual highlighting)
        applyFiltersAndSorting();

        // Add event listeners for filter and sort changes
        document.getElementById('filterOptions').addEventListener('change', applyFiltersAndSorting);
        document.getElementById('sortOptions').addEventListener('change', applyFiltersAndSorting);

        // Add event listener for dark mode toggle
        document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
    });
</script>
</body>
</html>